<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 车险索赔频率预测 | 现代精算统计模型</title>
  <meta name="description" content="The output format is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="1 车险索赔频率预测 | 现代精算统计模型" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The output format is bookdown::gitbook." />
  <meta name="github-repo" content="sxpyggy/Modern-Actuarial-Models" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 车险索赔频率预测 | 现代精算统计模型" />
  
  <meta name="twitter:description" content="The output format is bookdown::gitbook." />
  

<meta name="author" content="Modern Actuarial Models" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch0.html"/>

<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>



<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">现代精算统计模型</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>👨‍🏫 欢迎</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#答疑"><i class="fa fa-check"></i>🤔 答疑</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#课程安排"><i class="fa fa-check"></i>🗓️ 课程安排</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ch0.html"><a href="ch0.html"><i class="fa fa-check"></i>准备工作</a>
<ul>
<li class="chapter" data-level="0.1" data-path="ch0.html"><a href="ch0.html#克隆代码"><i class="fa fa-check"></i><b>0.1</b> 克隆代码</a></li>
<li class="chapter" data-level="0.2" data-path="ch0.html"><a href="ch0.html#建立环境"><i class="fa fa-check"></i><b>0.2</b> 建立环境</a>
<ul>
<li class="chapter" data-level="0.2.1" data-path="ch0.html"><a href="ch0.html#r-interface-to-keras"><i class="fa fa-check"></i><b>0.2.1</b> R interface to Keras</a></li>
<li class="chapter" data-level="0.2.2" data-path="ch0.html"><a href="ch0.html#r-interface-to-python"><i class="fa fa-check"></i><b>0.2.2</b> R interface to Python</a></li>
<li class="chapter" data-level="0.2.3" data-path="ch0.html"><a href="ch0.html#python"><i class="fa fa-check"></i><b>0.2.3</b> Python</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ch1.html"><a href="ch1.html"><i class="fa fa-check"></i><b>1</b> 车险索赔频率预测</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ch1.html"><a href="ch1.html#背景介绍"><i class="fa fa-check"></i><b>1.1</b> 背景介绍</a></li>
<li class="chapter" data-level="1.2" data-path="ch1.html"><a href="ch1.html#预测模型"><i class="fa fa-check"></i><b>1.2</b> 预测模型</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/sxpyggy/Modern-Actuarial-Models/tree/modern-actuarial-models" target="blank">GitHub repo</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">现代精算统计模型</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch1" class="section level1" number="1">
<h1><span class="header-section-number">1</span> 车险索赔频率预测</h1>
<div id="背景介绍" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> 背景介绍</h2>
<p>车险数据量大，风险特征多，对车险数据分析时可以体现出机器学习算法的优势，即使用算法从大数据中挖掘有用信息、提取特征。</p>
<p>在精算中，常常使用车险保单数据和历史索赔数据进行风险分析、车险定价等。保单数据库是在承保的时候建立的，索赔数据库是在索赔发生时建立的，大部分保单没有发生索赔，所以它们不会在索赔数据库中体现。</p>
<p>保单数据库记录了车险的风险信息，包括：</p>
<ol style="list-style-type: decimal">
<li><p>驾驶员特征：年龄、性别、工作、婚姻、地址等</p></li>
<li><p>车辆特征：品牌、车座数、车龄、价格、马力等</p></li>
<li><p>保单信息：保单编号、承保日期、到期日期</p></li>
<li><p>奖惩系数</p></li>
</ol>
<p>索赔数据库记录了保单的索赔信息，可以得到索赔次数<span class="math inline">\(N\)</span>和每次的索赔金额<span class="math inline">\(Y_l,l=1,\ldots,N\)</span>。理论上，车险的纯保费为以下随机和的期望</p>
<p><span class="math display">\[S=\sum_{l=1}^N Y_l\]</span>
假设索赔次数<span class="math inline">\(N\)</span>和索赔金额<span class="math inline">\(Y_l\)</span>独立且<span class="math inline">\(Y_l\)</span>服从独立同分布，则
<span class="math display">\[\mathbf{E}(S)=\mathbf{E}(N)\times\mathbf{E}(Y)\]</span></p>
<p>所以，车险定价问题很多时候都转化为两个独立模型：索赔次数（频率）模型和索赔金额（强度）模型。对于索赔次数模型，通常假设因变量服从泊松分布，建立泊松回归模型，使用的数据量等于保单数；对于索赔金额模型，通常假设因变量服从伽马分布，建立伽马回归模型，使用的数据量等于发生索赔的保单数。通常，在数据量不大时，索赔金额模型的建立难于索赔次数模型，因为只有发生索赔的保单才能用于索赔金额模型的建立。</p>
<p>记第<span class="math inline">\(i\)</span>个保单的风险信息为<span class="math inline">\(x_i\in\mathcal{X}\)</span>，保险公司定价的目标就是找到两个（最优）回归方程（映射），使之尽可能准确地预测索赔频率和索赔强度:</p>
<p><span class="math display">\[\lambda: \mathcal{X}\rightarrow \mathbf{R}_+, ~~~ x \mapsto \lambda(x_i)\]</span>
<span class="math display">\[\mu: \mathcal{X}\rightarrow \mathbf{R}_+, ~~~ x \mapsto \mu(x_i)\]</span></p>
<p>这里，<span class="math inline">\(\lambda(x_i)\)</span>是对<span class="math inline">\(N\)</span>的期望的估计，<span class="math inline">\(\mu(x_i)\)</span>是对<span class="math inline">\(Y\)</span>的期望的估计。基于这两个模型，纯保费估计为<span class="math inline">\(\lambda(x_i)\mu(x_i)\)</span>。</p>
</div>
<div id="预测模型" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> 预测模型</h2>
<p>如何得到一个好的预测模型呢？可以从两个方面考虑：</p>
<ol style="list-style-type: decimal">
<li><p>让风险信息空间<span class="math inline">\(\mathcal{X}\)</span>丰富，也称为特征工程，比如包含<span class="math inline">\(x,x^2,\ln x\)</span>、或者加入车联网信息。</p></li>
<li><p>让映射空间<span class="math inline">\(\lambda\in{\Lambda},\mu\in M\)</span>丰富，如GLM只包含线性效应、相加效应，映射空间较小，神经网络包含非线性效应、交互作用，映射空间较大。</p></li>
</ol>
<p>当你选取了映射空间较小的GLM，通常需要进行仔细的特征工程，使得风险信息空间适于GLM；当你选取了映射空间较大的神经网络，通常不需要进行特别仔细的特征工程，神经网络可以自动进行特征工程，发掘风险信息中的有用特征。</p>
<ul>
<li><p>对于传统的统计回归模型，GLM，GAM，MARS，我们使用极大似然方法在映射空间中找到最优的回归方程，在极大似然中使用的数据集称为学习集（learning data set）。为了防止过拟合，我们需要进行协变量选择，可以删掉不显著的协变量，也可以使用逐步回归，或者最优子集，判断标准为AIC等。</p></li>
<li><p>对于树模型，我们使用 recursive partitioning by binary splits 算法对风险空间进行划分，使得各子空间内的应变量差异最小，差异通常使用偏差损失（deviance loss）度量。为了防止过拟合，通常使用交叉验证对树的深度进行控制。树模型训练使用的数据为学习集。</p></li>
<li><p>树模型的扩展为bootstrap aggregation（bagging）和random forest。第一种算法是对每个bootstrap样本建立树模型，然后平均每个树模型的预测；第二种算法类似第一种，但在建立树模型时，要求只在某些随机选定的协变量上分支。这两种扩展都属于集成学习（ensemble learning）。</p></li>
<li><p>提升算法有多种不同形式，它的核心思想类似逐步回归，区别是每步回归中需要依据上步的预测结果调整各个样本的权重，让上步预测结果差的样本在下步回归中占的权重较大。通常，每步回归使用的模型比较简单，如深度为3的树模型。提升算法也属于集成学习，和前面不同是它的弱学习器不是独立的，而bagging和rf的弱学习器是彼此独立的。</p></li>
<li><p>对于集成算法，通常需要调整弱学习器的结构参数，如树的深度，也要判断弱学习器的个数，这些称为tuning parameters，通常通过比较在验证集（validation）的损失进行调参，防止过拟合。弱学习器中的参数通过在训练集（training）上训练模型得到。训练集和验证集的并集为学习集。</p></li>
<li><p>前馈神经网络的输入神经元为风险信息，下一层神经元为上一层神经元的线性组合并通过激活函数的非线性变换，最后输出神经元为神经网络对因变量期望的预测，通过减小输出神经元与因变量观察值的差异，训练神经网络中的参数。神经网络含有非常多的参数，很难找到全局最优解，而且最优解必然造成过拟合，所以一般采用梯度下降法对参数进行迭代，使得训练集损失在每次迭代中都有下降趋势。通过比较验证集损失确定迭代次数和神经网络的结构参数，防止过拟合。</p></li>
</ul>
<p>如何评价一个预测模型的好坏呢？通常用样本外损失（test error）评价。对于索赔频率，使用泊松偏差损失，对于索赔强度，使用伽马偏差损失，可以证明这两个损失函数和似然函数成负相关。其中，平均泊松偏差损失为：</p>
<p><span class="math display">\[\mathcal{L}(\mathbf{N},\mathbf{\hat{N}})=\frac{2}{|\mathbf{N}|}\sum_{i}\left[\frac{\hat{N}_i}{N_i}-1-\ln\left(\frac{\hat{N}_i}{N_i}\right)\right]\]</span></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch0.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
